## atlas-hcl-gen-go

This is a command to generate Go struct from [Atlas HCL Schema](https://atlasgo.io/atlas-schema/hcl).

## Usage

Install the command.

```bash
go install github.com/ucpr/atlas-hcl-gen-go
```

Generate Go struct from Atlas HCL Schema.

```bash
atlas-hcl-gen-go -i schema.hcl -o output.go
```

Print version information.

```bash
atlas-hcl-gen-go -version
```

## Init Config

Initialize a config file with documented fields and accepted values.

```bash
# Writes ./atlas-hcl-gen-go.yaml (does not overwrite if exists)
atlas-hcl-gen-go -init

# Or specify a custom path
atlas-hcl-gen-go -init --config configs/atlas-hcl-gen-go.yaml
```

Use a config when generating.

```bash
atlas-hcl-gen-go -i schema.hcl -o output.go --config atlas-hcl-gen-go.yaml
```

## Config Options

- dialect: target dialect (`mysql`|`postgres`|`sqlite`)
- package: Go package name for generated file
- tag: struct tag key (e.g., `db`)
- null: null strategy (`smart`|`pointer`|`sqlnull`)
- decimal: DECIMAL/NUMERIC mapping (`string`|`big.Rat`)
- uuid: UUID mapping (`string`|`bytes16`)
- json: JSON/JSONB mapping (`raw`|`bytes`|`string`)
- strict_types: error on unsupported/ambiguous types (bool)
- mysql_tinyint1_as_bool: map MySQL `TINYINT` to `bool` (bool)
- enum: ENUM mapping (`string`|`named`)

### ENUM: named type + consts

- When `enum: named`, the generator emits a named Go type per enum column and const values.
- Type name: `<Table><Column>` (CamelCase). Example: `UsersStatus`.
- Const names: `<Type><ValueCamel>` with string literal assignments.
- Struct field type becomes the named enum type; null policy applies (e.g., `*UsersStatus`).

## Example

The input data uses the schema written in HCL below.

```hcl
schema "market" {}

table "users" {
  schema = schema.market
  column "name" {
    type = text
  }
  column "updated_at" {
    type = int
  }
  column "created_at" {
    type = int
  }
}
```

Execute the command.

```bash
atlas-hcl-gen-go -i schema.hcl -o output.go
```

The following Go struct will be generated.

```go
// Code generated by github.com/ucpr/atlas-hcl-gen-go. DO NOT EDIT.
// atlas-hcl-gen-go: 922707f-dirty
// source: testdata/schema.hcl

package main

type Users struct {
	Name      int `db:"name"`
	UpdatedAt int `db:"updated_at"`
	CreatedAt int `db:"created_at"`
}
```


## TODO

- [ ] Support some types
- [x] Support some RDBMS schemas (MySQL, PostgreSQL, SQLite, ...)

## Contributing

Contributions of any kind welcome!

## License

[MIT License](LICENSE)
